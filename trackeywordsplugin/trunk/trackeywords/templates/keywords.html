<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:py="http://genshi.edgewall.org/" py:strip="">


<style type="text/css">
.sel {
  text-decoration: underline;
}
</style>

<script type="text/javascript">
function initTags() {
    var el = document.getElementById('field-keywords');
    var currentTags = el.value.split(/\s+/);

    for(i in currentTags) {
        var link = document.getElementById('add_' + currentTags[i]);
        if(link)
            link.className = "sel";
    }
}

window.onload = initTags;

function addTag(w) {
    var el = document.getElementById('field-keywords');
    var orig = el.value;
    var newval = orig.replace(new RegExp('\\b' + w + '\\b'), '');
    var link = document.getElementById('add_' + w);
    if (orig != newval) {
        // remove tag.
        if(link) link.className = '';
    } else {
        newval = orig + (orig ? ' ' : '') + w;
        if(link) link.className = 'sel';
    }
    el.value = newval.replace(/^\s+/, '');
}
</script>

<fieldset id="keywords">
 <legend>Add Keywords</legend>
 <py:for
      each="name, title in keywords">
    <a href="#" onclick="javascript:addTag('${name}'); return false;"
       id="add_${name}"
       title="${title}">${name}</a> </py:for>
</fieldset>

</div>
